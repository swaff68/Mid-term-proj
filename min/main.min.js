var cargoLoad=3e3,weightCounter=0,waterContributionCount=0,mealsContributionCount=0,fuelContributionCount=0,waterNeeded=0,mealsNeeded=0,fuelNeeded=0,waterWeight=0,mealsWeight=0,fuelWeight=0,supplyArray=[],orgsArray=[],Supply=function(t,e,n){this.type=t,this.qty=e,this.weight=n},contributionArray=[];validSupplyTypes=["fuel","meals","water"];var Organization=function(t,e,n,o){this.name=t,this.waterContributed=e,this.mealsContributed=n,this.fuelContributed=o},ContributionInput=function(t,e,n){this.org=t,this.sType=e,this.qty=n},contributionStatus=function(t,e,n){.5>=n/e?t.addClass("red"):.8>n/e&&n/e>.5?(t.removeClass("red"),t.addClass("redYellow")):1>n/e&&n/e>=.8?(t.removeClass("red"),t.removeClass("redYellow"),t.addClass("yellowGreen")):n/e>=1&&(t.removeClass("red"),t.removeClass("redYellow"),t.removeClass("yellowGreen"),t.addClass("green"))};$(document).on("ready",function(){$(".btn-manager").click(function(){$(".btn-needed-supply").show(),$(".btn-contributed-supply").hide(),$(".btn-supplyContributors").show()}),$(".btn-contributor").click(function(){$(".btn-needed-supply").hide(),$(".btn-contributed-supply").show(),$(".supply-status").show(),$(".btn-supplyContributors").hide(),$(".orgMetrics").hide()}),$(".btn-needed-supply").click(function(){$("#supply-form").show(),$(".btn-needed-supply").hide()}),$(".btn-contributed-supply").click(function(){$("#contribution-form").show(),$(".btn-contributed-supply").hide(),$("#supply-form").remove(),$("#supplyType").append('<option class="bottles">Bottles of Water</option>'),$("#supplyType").append('<option class="meals1">Meals</option>'),$("#supplyType").append('<option class="liters1">Liters of Fuel</option>')}),$(".form-cancel").click(function(t){t.preventDefault(),$("#supply-form").hide(),$(".btn-needed-supply").show()}),$(".form-cancel1").click(function(t){t.preventDefault(),$("#contribution-form").hide(),$(".btn-contributed-supply").show()}),$(document).on("click",".form-submit",function(){$(".plane").remove(),$(".supply-status").show();var t=$("#supplyType").val();if(console.log(t),weightCounter+=$("#inputWeight").val()*$("#inputQuantity").val(),console.log(weightCounter),"Bottles of Water"===t?(waterNeeded=$("#inputQuantity").val(),waterWeight=$("#inputWeight").val(),console.log(waterNeeded)):"Liters of Fuel"===t?(fuelNeeded=$("#inputQuantity").val(),fuelWeight=$("#inputWeight").val()):"Meals"===t&&(mealsNeeded=$("#inputQuantity").val(),mealsWeight=$("#inputWeight").val()),$("#inputQuantity").val(""),$("#inputWeight").val(""),$(".suppliesRequested").empty(),$(".contContainer").empty(),fuelNeeded&&($(".suppliesRequested").append('<div class=" icons col-lg-3 text-center fuel" data-type="fuel" data-qty='+fuelNeeded+" data-weight="+fuelWeight+'><p class="icon-text">'+fuelNeeded+'  Liters of Fuel</p><button type="button" class="btn btn-supplies-needed btn-fuel btn-default btn-lg"><span class="glyphicon glyphicon-tint liters"></span><p class="remove"> x </p></button><p class="contributionsText">'+fuelContributionCount+" Total Contributions</p></div>"),$(".contContainer").append('<div class=" icons col-lg-2 text-center fuel" data-type="fuel" data-qty='+fuelNeeded+" data-weight="+fuelWeight+'><p class="icon-text">Liters of Fuel</p><button type="button" class="btn btn-supplies-needed btn-fuel btn-default btn-lg"><span class="glyphicon glyphicon-tint liters"></span></button></div>'),$(".liters1").remove()),mealsNeeded&&($(".suppliesRequested").append('<div  class=" icons col-lg-3 text-center meals" data-type="meal" data-qty='+mealsNeeded+" data-weight="+mealsWeight+'><p class="icon-text">'+mealsNeeded+' Meals</p><button type="button" class="btn btn-supplies-needed btn-meals btn-default btn-lg"><span class="glyphicon glyphicon-cutlery"></span><p class="remove"> x </p></button><p class="contributionsText">'+mealsContributionCount+" Total Contributions</p></div>"),$(".contContainer").append('<div  class=" icons col-lg-2 text-center meals" data-type="meal" data-qty='+mealsNeeded+" data-weight="+mealsWeight+'><p class="icon-text">Meals</p><button type="button" class="btn btn-supplies-needed btn-meals btn-default btn-lg"><span class="glyphicon glyphicon-cutlery"></span></button></div>'),$(".meals1").remove()),waterNeeded&&($(".suppliesRequested").append('<div class=" icons col-lg-3 text-center water" data-type="water" data-qty='+waterNeeded+" data-weight="+waterWeight+'><p class="icon-text">'+waterNeeded+' Bottles of Water</p><button type="button" class="btn btn-supplies-needed btn-water btn-default btn-lg"><span class="glyphicon glyphicon-tint"></span><p class="remove"> x </p></button><p class="contributionsText">'+waterContributionCount+" Total Contributions</p> </div>"),$(".contContainer").append('<div class=" icons col-lg-2 text-center water" data-type="water" data-qty='+waterNeeded+" data-weight="+waterWeight+'><p class="icon-text"> Bottles of Water</p><button type="button" class="btn btn-supplies-needed btn-water btn-default btn-lg"><span class="glyphicon glyphicon-tint"></span></button> </div>'),$(".bottles").remove()),weightCounter>=cargoLoad){var e=Math.floor(weightCounter/cargoLoad);$(".supply-status").append('<div class=" icons col-lg-3 text-center plane"><button type="button" class="btn btn-supplies-needed btn-default btn-lg"><span class="glyphicon glyphicon-plane"></span></button><p class="icon-text plane-text">'+e+" Flights Required</p></div>"),console.log(e)}return!1}),$(document).on("click",".btn-supplyContributors",function(){$(".orgMetrics").toggle()}),$(document).on("click",".form-submit1",function(t){t.preventDefault();var e=$("#inputOrg").val(),n=$("#supplyType").val();console.log(name);var o=+$("#inputQuantity1").val();$("#inputQuantity1").val(""),console.log(o);var s={};if(_.where(orgsArray,{name:e}).length)s=_.where(orgsArray,{name:e})[0];else{var s=new Organization(e,0,0,0);orgsArray.push(s)}"Bottles of Water"===n?(s.waterContributed+=o,waterContributionCount+=+o,$(".water .contributionsText").text(waterContributionCount+" Total Contributions"),$icon=$(".btn-water"),contributionStatus($icon,waterNeeded,waterContributionCount)):"Liters of Fuel"===n?(s.fuelContributed+=o,fuelContributionCount+=+o,$(".fuel .contributionsText").text(fuelContributionCount+" Total Contributions"),$icon=$(".btn-fuel"),contributionStatus($icon,fuelNeeded,fuelContributionCount)):"Meals"===n&&(s.mealsContributed+=o,mealsContributionCount+=+o,$(".meals .contributionsText").text(mealsContributionCount+" Total Contributions"),$icon=$(".btn-meals"),contributionStatus($icon,mealsNeeded,mealsContributionCount)),console.log(weightCounter),$(".orgContribution").empty();for(var l=0;l<orgsArray.length;l++){var a=orgsArray[l].waterContributed+orgsArray[l].fuelContributed+orgsArray[l].mealsContributed,i=$('<div class="row contStats"></div>');$(i).append('<div class="col-lg-2 orgName">'+orgsArray[l].name+"</div>"),$(i).append('<div class="col-lg-2 contTotal">'+a+"</div>"),fuelNeeded&&$(i).append('<div class="col-lg-2 qtyfuel qtyText">'+orgsArray[l].fuelContributed+"</div>"),mealsNeeded&&$(i).append('<div class="col-lg-2 qtyMeals qtyText">'+orgsArray[l].mealsContributed+"</div>"),waterNeeded&&$(i).append('<div class="col-lg-2 qtyWater qtyText">'+orgsArray[l].waterContributed+"</div>"),$(".orgContribution").append(i),l%2&&i.css({"background-color":"lightblue"})}}),$(document).on("click",".remove",function(){$(".plane").remove();var t=$(this).closest(".icons").attr("data-type");"water"===t?($("#supplyType").append('<option class="bottles">Bottles of Water</option>'),waterNeeded=0):"meal"===t?($("#supplyType").append('<option class="meals1">Meals</option>'),mealsNeeded=0):"fuel"===t&&($("#supplyType").append('<option class="liters1">Liters of Fuel</option>'),fuelNeeded=0);var e=$(this).closest(".icons").attr("data-qty"),n=$(this).closest(".icons").attr("data-weight");if($(this).closest(".icons").remove(),console.log(e,n),weightCounter-=e*n,weightCounter>=cargoLoad){var o=Math.floor(weightCounter/cargoLoad);$(".supply-status").append('<div class=" icons col-lg-3 text-center plane"><button type="button" class="btn btn-supplies-needed btn-default btn-lg"><span class="glyphicon glyphicon-plane"></span></button><p class="icon-text">'+o+" Flights Required <br> Every 30 days</p></div>"),console.log(o)}$(".suppliesRequested").children().length<1&&(console.log("r"),$(".supply-status").hide())})});